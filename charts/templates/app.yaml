apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: node-food-api
spec:
  project: default
  source:
    repoURL: https://github.com/onurbilginnn/argo-helm.git
    targetRevision: main
    path: ./charts/
    helm:
      values: |
        replicaCount: 2
        service:
          port: 8081
          targetPort: 8081
    plugin: 
      env: 
      - name: PORT
        value: "3000"
      # - name: "PORT"
      #   valueFrom:
      #     secretKeyRef:
      #       key:  port
      #       name: {{ .Release.Name }}-auth
      # - name: "DB_USER"
      #   valueFrom:
      #     secretKeyRef:
      #       key:  dbUser
      #       name: {{ .Release.Name }}-auth
      # - name: "DATABASE_PASSWORD"
      #   valueFrom:
      #     secretKeyRef:
      #       key:  databasePassword
      #       name: {{ .Release.Name }}-auth
      # - name: "DB_HOST"
      #   valueFrom:
      #     secretKeyRef:
      #       key:  dbHost
      #       name: {{ .Release.Name }}-auth
      # - name: "DB_DATABASE"
      #   valueFrom:
      #     secretKeyRef:
      #       key:  database
      #       name: {{ .Release.Name }}-auth
      # - name: "DB_PORT"
      #   valueFrom:
      #     secretKeyRef:
      #       key:  dbPort
      #       name: {{ .Release.Name }}-auth
      # - name: "NODE_ENV"
      #   valueFrom:
      #     secretKeyRef:
      #       key:  nodeEnv
      #       name: {{ .Release.Name }}-auth
  destination:
    server: https://kubernetes.default.svc
    namespace: default
  syncPolicy:
    automated: {}